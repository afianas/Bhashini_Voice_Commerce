<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Bhashini â€” Voice Commerce Platform</title>
<link href="https://fonts.googleapis.com/css2?family=DM+Sans:wght@300;400;500;600;700&family=DM+Mono:wght@400;500&family=Playfair+Display:wght@600;700&display=swap" rel="stylesheet">
<style>
/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   DESIGN SYSTEM
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
:root {
  --bg:        #0D0F14;
  --surface-1: #141720;
  --surface-2: #1C2030;
  --surface-3: #242840;
  --border:    rgba(255,255,255,0.07);
  --border-hi: rgba(255,255,255,0.14);

  --gold:      #D4A853;
  --gold-dim:  #A07830;
  --gold-pale: rgba(212,168,83,0.1);
  --gold-glow: rgba(212,168,83,0.18);

  --green:     #34D399;
  --green-dim: rgba(52,211,153,0.12);
  --red:       #F87171;
  --red-dim:   rgba(248,113,113,0.12);
  --blue:      #60A5FA;
  --blue-dim:  rgba(96,165,250,0.12);

  --text-1: #F1F3F8;
  --text-2: #8B91A8;
  --text-3: #555C78;

  --radius:    14px;
  --radius-sm: 9px;
  --radius-xs: 6px;

  --shadow-sm: 0 1px 3px rgba(0,0,0,0.4);
  --shadow-md: 0 4px 24px rgba(0,0,0,0.5);
  --shadow-lg: 0 16px 64px rgba(0,0,0,0.7);
}

*, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

body {
  font-family: 'DM Sans', sans-serif;
  background: var(--bg);
  color: var(--text-1);
  min-height: 100vh;
  overflow-x: hidden;
}

/* Subtle grid texture */
body::before {
  content: '';
  position: fixed; inset: 0; z-index: 0; pointer-events: none;
  background-image:
    linear-gradient(rgba(212,168,83,0.025) 1px, transparent 1px),
    linear-gradient(90deg, rgba(212,168,83,0.025) 1px, transparent 1px);
  background-size: 48px 48px;
}

/* Ambient glows */
body::after {
  content: '';
  position: fixed; inset: 0; z-index: 0; pointer-events: none;
  background:
    radial-gradient(ellipse 60% 40% at 15% 0%, rgba(212,168,83,0.06) 0%, transparent 60%),
    radial-gradient(ellipse 40% 30% at 85% 90%, rgba(96,165,250,0.05) 0%, transparent 60%);
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   LAYOUT SHELL
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.shell { display: flex; flex-direction: column; min-height: 100vh; position: relative; z-index: 1; }

/* â”€â”€ TOPBAR â”€â”€ */
.topbar {
  height: 60px;
  background: rgba(20,23,32,0.92);
  backdrop-filter: blur(16px);
  border-bottom: 1px solid var(--border);
  display: flex; align-items: center; justify-content: space-between;
  padding: 0 28px;
  position: sticky; top: 0; z-index: 200;
}

.brand { display: flex; align-items: center; gap: 10px; }
.brand-mark {
  width: 32px; height: 32px;
  background: linear-gradient(135deg, var(--gold), var(--gold-dim));
  border-radius: 8px;
  display: flex; align-items: center; justify-content: center;
  font-size: 15px;
  box-shadow: 0 0 16px var(--gold-glow);
}
.brand-name {
  font-family: 'Playfair Display', serif;
  font-size: 20px; font-weight: 700;
  color: var(--text-1); letter-spacing: -0.3px;
}
.brand-name em { color: var(--gold); font-style: normal; }
.brand-tag {
  font-size: 10px; font-weight: 600; letter-spacing: 1.4px;
  color: var(--text-3); text-transform: uppercase; margin-left: 2px; margin-top: 2px;
}

.topbar-right { display: flex; align-items: center; gap: 8px; }

.lang-pill {
  display: flex; align-items: center;
  background: var(--surface-2);
  border: 1px solid var(--border);
  border-radius: 30px;
  padding: 3px 4px;
  gap: 2px;
}
.lang-btn {
  padding: 5px 13px; border-radius: 24px; border: none; background: transparent;
  color: var(--text-2); font-family: 'DM Sans', sans-serif;
  font-size: 12px; font-weight: 500; cursor: pointer; transition: all 0.2s;
  white-space: nowrap;
}
.lang-btn:hover { color: var(--text-1); background: var(--surface-3); }
.lang-btn.active { background: var(--gold); color: #0D0F14; font-weight: 700; box-shadow: 0 0 12px var(--gold-glow); }

.topbar-date {
  font-family: 'DM Mono', monospace;
  font-size: 11px; color: var(--text-3);
  padding: 5px 12px;
  background: var(--surface-2);
  border: 1px solid var(--border);
  border-radius: 6px;
  white-space: nowrap;
}

/* â”€â”€ PAGE CONTENT â”€â”€ */
.page { padding: 24px 28px 60px; max-width: 1200px; margin: 0 auto; width: 100%; }

/* â”€â”€ SECTION HEADING â”€â”€ */
.section-label {
  font-size: 10px; font-weight: 600; letter-spacing: 1.8px;
  color: var(--text-3); text-transform: uppercase; margin-bottom: 12px;
}

/* â”€â”€ GRID â”€â”€ */
.grid-main { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 16px; align-items: start; }
.col-voice { grid-column: 1 / 3; display: flex; flex-direction: column; gap: 16px; }
.col-right  { grid-column: 3 / 4; display: flex; flex-direction: column; gap: 16px; }

/* â”€â”€ CARD â”€â”€ */
.card {
  background: var(--surface-1);
  border: 1px solid var(--border);
  border-radius: var(--radius);
  box-shadow: var(--shadow-sm);
  overflow: hidden;
  transition: border-color 0.3s;
}
.card:hover { border-color: var(--border-hi); }

.card-head {
  padding: 14px 18px 12px;
  border-bottom: 1px solid var(--border);
  display: flex; align-items: center; justify-content: space-between;
}
.card-title {
  display: flex; align-items: center; gap: 8px;
  font-size: 12px; font-weight: 600; letter-spacing: 0.6px;
  color: var(--text-2); text-transform: uppercase;
}
.card-icon {
  width: 26px; height: 26px; border-radius: 7px;
  display: flex; align-items: center; justify-content: center;
  font-size: 13px;
}
.card-icon.gold   { background: var(--gold-pale); }
.card-icon.green  { background: var(--green-dim); }
.card-icon.blue   { background: var(--blue-dim); }
.card-icon.red    { background: var(--red-dim); }

.card-badge {
  font-size: 10px; font-weight: 600; padding: 3px 9px; border-radius: 12px;
  letter-spacing: 0.4px; text-transform: uppercase;
}
.card-badge.live { background: rgba(52,211,153,0.15); color: var(--green); }
.card-badge.idle { background: var(--surface-3); color: var(--text-3); }

.card-body { padding: 18px; }

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   VOICE MODULE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.voice-module {
  display: grid;
  grid-template-columns: auto 1fr;
  gap: 24px;
  align-items: center;
}

/* MIC BUTTON */
.mic-wrap { display: flex; flex-direction: column; align-items: center; gap: 12px; }

.mic-outer {
  width: 100px; height: 100px; border-radius: 50%;
  display: flex; align-items: center; justify-content: center;
  background: conic-gradient(from 0deg, var(--gold) 0%, var(--gold-dim) 50%, var(--gold) 100%);
  padding: 2px;
  box-shadow: 0 0 0 0 var(--gold-glow);
  transition: box-shadow 0.3s;
  cursor: pointer;
}
.mic-outer.armed { box-shadow: 0 0 24px 8px var(--gold-glow); }
.mic-outer.recording-ring { animation: ring-pulse 1.1s ease-in-out infinite; }
.mic-outer.processing-ring { animation: ring-spin 1.4s linear infinite; }

@keyframes ring-pulse {
  0%,100% { box-shadow: 0 0 0 0 rgba(248,113,113,0.5); }
  50%      { box-shadow: 0 0 0 18px rgba(248,113,113,0); }
}
@keyframes ring-spin {
  0%   { box-shadow: 0 0 20px 4px rgba(212,168,83,0.3); filter: hue-rotate(0deg); }
  100% { box-shadow: 0 0 20px 4px rgba(212,168,83,0.3); filter: hue-rotate(360deg); }
}

.mic-inner {
  width: 94px; height: 94px; border-radius: 50%;
  background: var(--surface-2);
  display: flex; align-items: center; justify-content: center;
  font-size: 36px;
  transition: background 0.3s;
  border: none; cursor: pointer;
}
.mic-inner:disabled { cursor: not-allowed; opacity: 0.5; }
.mic-inner.recording  { background: rgba(248,113,113,0.15); }
.mic-inner.processing { background: rgba(212,168,83,0.08); }

.mic-state-label {
  font-size: 11px; font-weight: 600; letter-spacing: 0.8px; text-transform: uppercase;
  color: var(--text-3); text-align: center; transition: color 0.3s;
}
.mic-state-label.live  { color: var(--red); }
.mic-state-label.proc  { color: var(--gold); }

/* WAVEFORM */
.waveform {
  display: flex; align-items: center; gap: 3px;
  height: 32px; opacity: 0; transition: opacity 0.3s;
}
.waveform.active { opacity: 1; }
.waveform .bar {
  width: 3px; border-radius: 2px; background: var(--red);
  animation: wave-anim 0.7s ease-in-out infinite; transform-origin: center;
}
.waveform .bar:nth-child(1) { height: 8px;  animation-delay: 0s; }
.waveform .bar:nth-child(2) { height: 16px; animation-delay: 0.08s; }
.waveform .bar:nth-child(3) { height: 24px; animation-delay: 0.16s; }
.waveform .bar:nth-child(4) { height: 32px; animation-delay: 0.12s; }
.waveform .bar:nth-child(5) { height: 24px; animation-delay: 0.04s; }
.waveform .bar:nth-child(6) { height: 16px; animation-delay: 0.2s; }
.waveform .bar:nth-child(7) { height: 8px;  animation-delay: 0.06s; }
@keyframes wave-anim {
  0%,100% { transform: scaleY(0.35); }
  50%     { transform: scaleY(1); }
}

/* VOICE RIGHT PANEL */
.voice-right { display: flex; flex-direction: column; gap: 14px; }

.hint-strip {
  background: var(--gold-pale);
  border: 1px solid rgba(212,168,83,0.2);
  border-radius: var(--radius-sm);
  padding: 10px 14px;
  font-size: 13px; color: var(--gold); line-height: 1.55;
  font-style: italic;
  display: flex; align-items: flex-start; gap: 8px;
}
.hint-strip::before { content: 'ğŸ’¬'; font-style: normal; margin-top: 1px; flex-shrink: 0; }

.transcript-area {
  background: var(--surface-2);
  border: 1px solid var(--border);
  border-radius: var(--radius-sm);
  padding: 13px 15px;
  min-height: 58px;
  font-size: 14px; color: var(--text-2); line-height: 1.6;
  transition: border-color 0.3s, background 0.3s;
  position: relative;
}
.transcript-area.has-text {
  color: var(--text-1);
  border-color: rgba(52,211,153,0.3);
  background: rgba(52,211,153,0.04);
}
.transcript-area.loading {
  border-color: rgba(212,168,83,0.3);
  background: rgba(212,168,83,0.04);
}

/* Blinking cursor for loading state */
.transcript-area.loading::after {
  content: '|';
  animation: blink 0.8s step-end infinite;
  color: var(--gold);
}
@keyframes blink { 0%,100%{opacity:1} 50%{opacity:0} }

/* Timer row */
.timer-row {
  display: flex; align-items: center; gap: 10px;
}
.rec-dot {
  width: 8px; height: 8px; border-radius: 50%;
  background: var(--red);
  animation: dot-blink 1s step-start infinite;
  opacity: 0; flex-shrink: 0;
}
.rec-dot.active { opacity: 1; }
@keyframes dot-blink { 0%,100%{opacity:1} 50%{opacity:0} }
.rec-timer {
  font-family: 'DM Mono', monospace;
  font-size: 14px; font-weight: 500; color: var(--red);
  opacity: 0; transition: opacity 0.2s;
}
.rec-timer.active { opacity: 1; }
.rec-timer-label { font-size: 11px; color: var(--text-3); }

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   DASHBOARD STATS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.stats-band { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 12px; padding: 16px 18px; }
.stat-tile {
  background: var(--surface-2);
  border: 1px solid var(--border);
  border-radius: var(--radius-sm);
  padding: 14px 16px;
  position: relative; overflow: hidden;
  transition: border-color 0.2s;
}
.stat-tile:hover { border-color: var(--border-hi); }
.stat-tile::before {
  content: ''; position: absolute; inset: 0;
  background: linear-gradient(135deg, rgba(212,168,83,0.04) 0%, transparent 60%);
  pointer-events: none;
}
.stat-lbl { font-size: 10px; font-weight: 600; letter-spacing: 1.2px; color: var(--text-3); text-transform: uppercase; margin-bottom: 6px; }
.stat-val {
  font-family: 'DM Mono', monospace;
  font-size: 24px; font-weight: 500; color: var(--text-1);
  letter-spacing: -0.5px;
}
.stat-val.green { color: var(--green); }
.stat-val.gold  { color: var(--gold); }
.stat-change {
  font-size: 11px; color: var(--text-3); margin-top: 4px;
  display: flex; align-items: center; gap: 4px;
}
.stat-change.up { color: var(--green); }

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   TRANSACTION TABLE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.txn-table { width: 100%; padding: 0 18px 16px; }
.txn-row {
  display: grid;
  grid-template-columns: 32px 1fr auto auto;
  align-items: center;
  gap: 12px;
  padding: 10px 0;
  border-bottom: 1px solid var(--border);
  animation: fadeSlide 0.3s ease;
}
.txn-row:last-child { border-bottom: none; }
@keyframes fadeSlide { from { opacity:0; transform:translateX(-6px); } to { opacity:1; transform:none; } }

.txn-icon {
  width: 32px; height: 32px; border-radius: 8px;
  display: flex; align-items: center; justify-content: center;
  font-size: 14px; flex-shrink: 0;
}
.txn-icon.sale     { background: var(--green-dim); }
.txn-icon.purchase { background: var(--blue-dim); }

.txn-name { font-size: 13px; font-weight: 600; color: var(--text-1); }
.txn-sub  { font-size: 11px; color: var(--text-3); margin-top: 1px; }
.txn-time { font-family: 'DM Mono', monospace; font-size: 11px; color: var(--text-3); }
.txn-amount { font-family: 'DM Mono', monospace; font-size: 13px; font-weight: 500; text-align: right; }
.txn-amount.pos { color: var(--green); }
.txn-amount.neg { color: var(--red); }

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   INVENTORY
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.inv-form {
  display: grid; grid-template-columns: 1fr 1fr; gap: 10px;
  padding: 16px 18px;
  border-bottom: 1px solid var(--border);
}
.f-group { display: flex; flex-direction: column; gap: 5px; }
.f-group.full { grid-column: 1/-1; }
.f-lbl { font-size: 10px; font-weight: 600; letter-spacing: 1px; text-transform: uppercase; color: var(--text-3); }
.f-inp {
  padding: 9px 11px; border-radius: var(--radius-xs);
  border: 1px solid var(--border);
  background: var(--surface-2);
  color: var(--text-1); font-family: 'DM Sans', sans-serif; font-size: 13px;
  outline: none; transition: border-color 0.2s, background 0.2s;
}
.f-inp:focus { border-color: var(--gold); background: var(--surface-3); }
.f-inp option { background: var(--surface-2); }

.btn-add {
  grid-column: 1/-1; padding: 10px 14px;
  border-radius: var(--radius-xs); border: 1px solid rgba(212,168,83,0.3);
  background: var(--gold-pale);
  color: var(--gold); font-family: 'DM Sans', sans-serif;
  font-size: 12px; font-weight: 700; letter-spacing: 0.6px;
  cursor: pointer; transition: all 0.2s; text-transform: uppercase;
}
.btn-add:hover { background: var(--gold); color: var(--bg); border-color: var(--gold); }

.inv-list { padding: 4px 18px 14px; }
.inv-row {
  display: grid; grid-template-columns: 1fr auto;
  align-items: center; gap: 12px;
  padding: 10px 0; border-bottom: 1px solid var(--border);
}
.inv-row:last-child { border-bottom: none; }
.inv-name  { font-size: 13px; font-weight: 600; color: var(--text-1); }
.inv-stock { font-family: 'DM Mono', monospace; font-size: 11px; color: var(--text-3); margin-top: 2px; }
.stock-track { width: 70px; height: 4px; background: var(--surface-3); border-radius: 2px; margin-top: 5px; overflow: hidden; }
.stock-fill { height: 100%; border-radius: 2px; transition: width 0.5s ease; }
.stock-fill.hi  { background: var(--green); }
.stock-fill.mid { background: var(--gold); }
.stock-fill.lo  { background: var(--red); }
.inv-right { display: flex; align-items: center; gap: 8px; flex-direction: column; align-items: flex-end; }
.inv-price { font-family: 'DM Mono', monospace; font-size: 12px; color: var(--text-2); }
.badge-low { font-size: 9px; font-weight: 700; letter-spacing: 0.8px; text-transform: uppercase; padding: 2px 7px; border-radius: 10px; background: var(--red-dim); color: var(--red); }

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   UDHAAR
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.udhaar-total {
  margin: 0 18px 12px;
  padding: 12px 14px;
  background: var(--surface-2);
  border: 1px solid rgba(248,113,113,0.15);
  border-radius: var(--radius-sm);
  display: flex; justify-content: space-between; align-items: center;
}
.udhaar-total-lbl { font-size: 11px; font-weight: 600; letter-spacing: 0.6px; text-transform: uppercase; color: var(--text-3); }
.udhaar-total-val { font-family: 'DM Mono', monospace; font-size: 20px; font-weight: 500; color: var(--red); }

.udhaar-list { padding: 0 18px 8px; }
.udhaar-row { display: flex; align-items: center; justify-content: space-between; padding: 9px 0; border-bottom: 1px solid var(--border); }
.udhaar-row:last-child { border-bottom: none; }
.udhaar-name { font-size: 13px; font-weight: 600; color: var(--text-1); }
.udhaar-date { font-size: 11px; color: var(--text-3); margin-top: 2px; }
.udhaar-amt  { font-family: 'DM Mono', monospace; font-size: 14px; font-weight: 500; color: var(--red); }

.udhaar-form-row {
  display: grid; grid-template-columns: 1fr 1fr auto;
  gap: 8px; padding: 10px 18px 16px;
  border-top: 1px solid var(--border);
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   PREVIEW MODAL
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.overlay {
  position: fixed; inset: 0; z-index: 400;
  background: rgba(13,15,20,0.85); backdrop-filter: blur(8px);
  display: flex; align-items: center; justify-content: center;
  opacity: 0; pointer-events: none; transition: opacity 0.25s;
}
.overlay.show { opacity: 1; pointer-events: all; }

.modal {
  background: var(--surface-1);
  border: 1px solid var(--border-hi);
  border-radius: 18px;
  width: min(480px, 92vw);
  box-shadow: var(--shadow-lg);
  transform: translateY(16px) scale(0.98);
  transition: transform 0.25s cubic-bezier(0.34,1.56,0.64,1);
  overflow: hidden;
}
.overlay.show .modal { transform: translateY(0) scale(1); }

.modal-head {
  padding: 18px 22px 16px;
  border-bottom: 1px solid var(--border);
  display: flex; align-items: center; justify-content: space-between;
  background: linear-gradient(135deg, rgba(212,168,83,0.06) 0%, transparent 100%);
}
.modal-head-left { display: flex; align-items: center; gap: 10px; }
.modal-icon { font-size: 20px; }
.modal-title { font-size: 16px; font-weight: 700; color: var(--text-1); }
.modal-sub { font-size: 11px; color: var(--text-3); margin-top: 1px; }
.modal-close-btn {
  width: 28px; height: 28px; border-radius: 7px;
  background: var(--surface-3); border: 1px solid var(--border);
  color: var(--text-2); font-size: 13px; cursor: pointer;
  display: flex; align-items: center; justify-content: center;
  transition: all 0.2s;
}
.modal-close-btn:hover { background: var(--red-dim); color: var(--red); border-color: var(--red); }

.modal-body { padding: 20px 22px; display: flex; flex-direction: column; gap: 16px; }

/* Transcript quote */
.modal-quote {
  background: var(--surface-2);
  border-left: 3px solid var(--gold);
  border-radius: 0 var(--radius-xs) var(--radius-xs) 0;
  padding: 11px 14px;
  font-size: 13px; font-style: italic; color: var(--text-2); line-height: 1.6;
}

/* Confidence */
.conf-row { display: flex; flex-direction: column; gap: 6px; }
.conf-header { display: flex; justify-content: space-between; align-items: center; }
.conf-label { font-size: 10px; font-weight: 600; letter-spacing: 1.2px; text-transform: uppercase; color: var(--text-3); }
.conf-badge {
  font-family: 'DM Mono', monospace; font-size: 13px; font-weight: 500;
  padding: 2px 10px; border-radius: 12px; transition: all 0.3s;
}
.conf-badge.hi  { background: var(--green-dim); color: var(--green); }
.conf-badge.mid { background: var(--gold-pale);  color: var(--gold); }
.conf-badge.lo  { background: var(--red-dim);    color: var(--red); }
.conf-track { height: 6px; background: var(--surface-3); border-radius: 3px; overflow: hidden; }
.conf-bar { height: 100%; border-radius: 3px; width: 0; transition: width 0.7s cubic-bezier(0.4,0,0.2,1); }
.conf-bar.hi  { background: linear-gradient(90deg, var(--green), #6EE7B7); }
.conf-bar.mid { background: linear-gradient(90deg, var(--gold-dim), var(--gold)); }
.conf-bar.lo  { background: linear-gradient(90deg, #B91C1C, var(--red)); }

/* Parsed grid */
.parsed-grid { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 10px; }
.parse-field { background: var(--surface-2); border: 1px solid var(--border); border-radius: var(--radius-sm); padding: 12px 13px; transition: border-color 0.2s; }
.parse-field:focus-within { border-color: var(--gold); }
.parse-field-lbl { font-size: 9px; font-weight: 700; letter-spacing: 1.4px; text-transform: uppercase; color: var(--text-3); margin-bottom: 5px; }
.parse-input {
  width: 100%; background: transparent; border: none; outline: none;
  font-family: 'DM Sans', sans-serif; font-size: 15px; font-weight: 700;
  color: var(--text-1); padding: 0;
}
.parse-input option { background: var(--surface-2); }

.modal-footer { display: flex; gap: 10px; padding: 0 22px 20px; }
.btn-discard {
  padding: 11px 18px; border-radius: var(--radius-sm);
  border: 1px solid var(--border); background: transparent;
  color: var(--text-2); font-family: 'DM Sans', sans-serif;
  font-size: 13px; font-weight: 600; cursor: pointer; transition: all 0.2s;
}
.btn-discard:hover { border-color: var(--red); color: var(--red); background: var(--red-dim); }
.btn-save {
  flex: 1; padding: 11px 18px; border-radius: var(--radius-sm);
  border: none; background: var(--green);
  color: #0D0F14; font-family: 'DM Sans', sans-serif;
  font-size: 13px; font-weight: 700; cursor: pointer; transition: all 0.2s;
  display: flex; align-items: center; justify-content: center; gap: 6px;
  box-shadow: 0 0 16px rgba(52,211,153,0.2);
}
.btn-save:hover { background: #6EE7B7; box-shadow: 0 0 24px rgba(52,211,153,0.35); }

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   TOAST
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.toast {
  position: fixed; bottom: 24px; left: 50%;
  transform: translateX(-50%) translateY(70px);
  background: var(--surface-2); border: 1px solid var(--border-hi);
  color: var(--text-1); padding: 11px 20px; border-radius: 30px;
  font-size: 13px; font-weight: 500; z-index: 999;
  transition: transform 0.3s cubic-bezier(0.34,1.56,0.64,1);
  display: flex; align-items: center; gap: 8px;
  box-shadow: var(--shadow-md); white-space: nowrap;
  backdrop-filter: blur(12px);
}
.toast.show { transform: translateX(-50%) translateY(0); }
.toast.success { background: rgba(52,211,153,0.12); border-color: rgba(52,211,153,0.3); color: var(--green); }
.toast.error   { background: rgba(248,113,113,0.12); border-color: rgba(248,113,113,0.3); color: var(--red); }

/* â”€â”€ EMPTY STATE â”€â”€ */
.empty { text-align: center; padding: 20px; font-size: 12px; color: var(--text-3); }

/* â”€â”€ DIVIDER â”€â”€ */
.divider { height: 1px; background: var(--border); margin: 0 18px; }

/* â”€â”€ STAGGER REVEAL â”€â”€ */
.card { animation: cardIn 0.4s ease both; }
.card:nth-child(1) { animation-delay: 0.05s; }
.card:nth-child(2) { animation-delay: 0.10s; }
.card:nth-child(3) { animation-delay: 0.15s; }
.card:nth-child(4) { animation-delay: 0.20s; }
.card:nth-child(5) { animation-delay: 0.25s; }
@keyframes cardIn { from { opacity:0; transform:translateY(10px); } to { opacity:1; transform:none; } }

/* RESPONSIVE */
@media(max-width:900px) {
  .grid-main { grid-template-columns: 1fr; }
  .col-voice,.col-right { grid-column: 1; }
  .page { padding: 16px 16px 60px; }
  .topbar { padding: 0 16px; }
  .parsed-grid { grid-template-columns: 1fr 1fr; }
  .stats-band { grid-template-columns: 1fr 1fr; }
}
@media(max-width:520px) {
  .voice-module { grid-template-columns: 1fr; justify-items: center; }
  .lang-btn { padding: 4px 9px; font-size: 11px; }
  .brand-tag { display: none; }
}
</style>
</head>
<body>
<div class="shell">

<!-- â”€â”€ TOPBAR â”€â”€ -->
<header class="topbar">
  <div class="brand">
    <div class="brand-mark">à¤­</div>
    <div>
      <div class="brand-name">Bhashini<em>AI</em></div>
      <div class="brand-tag">Voice Commerce Platform</div>
    </div>
  </div>
  <div class="topbar-right">
    <div class="lang-pill">
      <button class="lang-btn active" onclick="setLang('hi',this)">à¤¹à¤¿à¤‚à¤¦à¥€</button>
      <button class="lang-btn" onclick="setLang('mr',this)">à¤®à¤°à¤¾à¤ à¥€</button>
      <button class="lang-btn" onclick="setLang('ta',this)">à®¤à®®à®¿à®´à¯</button>
      <button class="lang-btn" onclick="setLang('ml',this)">à´®à´²à´¯à´¾à´³à´‚</button>
      <button class="lang-btn" onclick="setLang('en',this)">EN</button>
    </div>
    <div class="topbar-date" id="topbarDate"></div>
  </div>
</header>

<!-- â”€â”€ TOAST â”€â”€ -->
<div class="toast" id="toast"></div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     PREVIEW MODAL
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="overlay" id="overlay">
  <div class="modal">
    <div class="modal-head">
      <div class="modal-head-left">
        <span class="modal-icon">ğŸ”</span>
        <div>
          <div class="modal-title">Confirm Entry</div>
          <div class="modal-sub">Review parsed data before saving</div>
        </div>
      </div>
      <button class="modal-close-btn" onclick="closeModal()">âœ•</button>
    </div>
    <div class="modal-body">
      <div class="modal-quote" id="modalQuote">â€”</div>

      <!-- Confidence -->
      <div class="conf-row">
        <div class="conf-header">
          <span class="conf-label">Confidence Score</span>
          <span class="conf-badge" id="confBadge">â€”</span>
        </div>
        <div class="conf-track"><div class="conf-bar" id="confBar"></div></div>
      </div>

      <!-- Editable parsed fields -->
      <div class="parsed-grid">
        <div class="parse-field">
          <div class="parse-field-lbl">Item</div>
          <input class="parse-input" id="mItem" placeholder="Product" />
        </div>
        <div class="parse-field">
          <div class="parse-field-lbl">Quantity</div>
          <input class="parse-input" id="mQty" type="number" placeholder="0" />
        </div>
        <div class="parse-field">
          <div class="parse-field-lbl">Type</div>
          <select class="parse-input" id="mType">
            <option value="sale">Sale â†‘</option>
            <option value="purchase">Purchase â†“</option>
          </select>
        </div>
      </div>
    </div>
    <div class="modal-footer">
      <button class="btn-discard" onclick="closeModal()">Discard</button>
      <button class="btn-save" onclick="confirmFromModal()">
        <span>âœ“</span> Save Entry
      </button>
    </div>
  </div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     PAGE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<main class="page">
  <div class="grid-main">

    <!-- LEFT / VOICE COLUMN -->
    <div class="col-voice">

      <!-- VOICE ENTRY CARD -->
      <div class="card">
        <div class="card-head">
          <div class="card-title">
            <div class="card-icon gold">ğŸ™ï¸</div>
            <span id="label-voice">Voice Entry</span>
          </div>
          <span class="card-badge idle" id="recBadge">IDLE</span>
        </div>
        <div class="card-body">
          <div class="voice-module">
            <div class="mic-wrap">
              <div class="mic-outer" id="micOuter">
                <button class="mic-inner" id="micBtn" onclick="toggleRecording()">ğŸ¤</button>
              </div>
              <div class="timer-row">
                <div class="rec-dot" id="recDot"></div>
                <div class="rec-timer" id="recTimer">0:00</div>
              </div>
              <div class="mic-state-label" id="micLabel">à¤¬à¥‹à¤²à¤¨à¤¾ à¤¶à¥à¤°à¥‚ à¤•à¤°à¥‡à¤‚</div>
            </div>
            <div class="voice-right">
              <div class="hint-strip" id="voice-hint">à¤†à¤œ à¤®à¥ˆà¤‚à¤¨à¥‡ 5 à¤²à¥€à¤Ÿà¤° à¤¦à¥‚à¤§ à¤”à¤° 2 à¤•à¤¿à¤²à¥‹ à¤šà¥€à¤¨à¥€ à¤¬à¥‡à¤šà¥€</div>
              <div class="waveform" id="waveform">
                <div class="bar"></div><div class="bar"></div><div class="bar"></div>
                <div class="bar"></div><div class="bar"></div><div class="bar"></div><div class="bar"></div>
              </div>
              <div class="transcript-area" id="transcriptBox">à¤¯à¤¹à¤¾à¤ à¤†à¤ªà¤•à¥€ à¤†à¤µà¤¾à¤œà¤¼ à¤¦à¤¿à¤–à¥‡à¤—à¥€...</div>
            </div>
          </div>
        </div>
      </div>

      <!-- DASHBOARD CARD -->
      <div class="card">
        <div class="card-head">
          <div class="card-title"><div class="card-icon green">ğŸ“Š</div><span id="label-dashboard">Dashboard</span></div>
          <span style="font-size:11px;color:var(--text-3);" id="dashDate"></span>
        </div>
        <div class="stats-band">
          <div class="stat-tile">
            <div class="stat-lbl" id="label-revenue">Revenue</div>
            <div class="stat-val gold" id="statRevenue">â‚¹0</div>
            <div class="stat-change">Today</div>
          </div>
          <div class="stat-tile">
            <div class="stat-lbl" id="label-profit">Profit</div>
            <div class="stat-val green" id="statProfit">â‚¹0</div>
            <div class="stat-change">Margin</div>
          </div>
          <div class="stat-tile">
            <div class="stat-lbl" id="label-txn-count">Transactions</div>
            <div class="stat-val" id="statTxnCount">0</div>
            <div class="stat-change">Today</div>
          </div>
        </div>

        <div class="divider"></div>
        <div class="card-head" style="border-top:none;">
          <div class="card-title"><div class="card-icon blue">ğŸ“‹</div><span id="label-txns">Recent Transactions</span></div>
        </div>
        <div class="txn-table" id="txnTable">
          <div class="empty" id="label-empty-txn">No transactions recorded today</div>
        </div>
      </div>

    </div>

    <!-- RIGHT COLUMN -->
    <div class="col-right">

      <!-- INVENTORY CARD -->
      <div class="card">
        <div class="card-head">
          <div class="card-title"><div class="card-icon gold">ğŸ“¦</div><span id="label-inventory">Inventory</span></div>
        </div>
        <div class="inv-form">
          <div class="f-group">
            <div class="f-lbl" id="label-pname">Product</div>
            <input class="f-inp" id="prodName" placeholder="e.g. à¤¦à¥‚à¤§ / Milk" />
          </div>
          <div class="f-group">
            <div class="f-lbl" id="label-punit">Unit</div>
            <select class="f-inp" id="prodUnit">
              <option>litre</option><option>kg</option>
              <option>piece</option><option>packet</option><option>dozen</option>
            </select>
          </div>
          <div class="f-group">
            <div class="f-lbl" id="label-pstock">Stock</div>
            <input class="f-inp" id="prodStock" type="number" placeholder="50" />
          </div>
          <div class="f-group">
            <div class="f-lbl" id="label-pbuy">Buy â‚¹</div>
            <input class="f-inp" id="prodBuy" type="number" placeholder="40" />
          </div>
          <div class="f-group full">
            <div class="f-lbl" id="label-psell">Sell â‚¹</div>
            <input class="f-inp" id="prodSell" type="number" placeholder="50" />
          </div>
          <button class="btn-add" onclick="addProduct()">+ <span id="label-addprod">Add Product</span></button>
        </div>
        <div class="inv-list" id="invList">
          <div class="empty" id="label-empty-inv">No products added yet</div>
        </div>
      </div>

      <!-- UDHAAR CARD -->
      <div class="card">
        <div class="card-head">
          <div class="card-title"><div class="card-icon red">ğŸ“’</div><span id="label-udhaar">Udhaar Bahi</span></div>
        </div>
        <div class="udhaar-total">
          <div class="udhaar-total-lbl" id="label-total-due">Total Outstanding</div>
          <div class="udhaar-total-val" id="totalDue">â‚¹0</div>
        </div>
        <div class="udhaar-list" id="udhaarList">
          <div class="empty" id="label-empty-udhaar">No credit entries</div>
        </div>
        <div class="udhaar-form-row">
          <input class="f-inp" id="udhaarName" placeholder="Customer name" />
          <input class="f-inp" id="udhaarAmt" type="number" placeholder="Amount â‚¹" />
          <button class="btn-add" style="padding:9px 14px;font-size:12px;" onclick="addUdhaar()">+</button>
        </div>
      </div>

    </div>
  </div>
</main>
</div>

<script>
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// TRANSLATIONS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const T = {
  hi: {
    'label-voice':'à¤†à¤µà¤¾à¤œà¤¼ à¤¸à¥‡ à¤à¤‚à¤Ÿà¥à¤°à¥€','label-dashboard':'à¤¡à¥ˆà¤¶à¤¬à¥‹à¤°à¥à¤¡','label-revenue':'à¤¬à¤¿à¤•à¥à¤°à¥€',
    'label-profit':'à¤®à¥à¤¨à¤¾à¤«à¤¼à¤¾','label-txn-count':'à¤²à¥‡à¤¨-à¤¦à¥‡à¤¨','label-txns':'à¤¹à¤¾à¤² à¤•à¥€ à¤¬à¤¿à¤•à¥à¤°à¥€',
    'label-inventory':'à¤¸à¥à¤Ÿà¥‰à¤•','label-udhaar':'à¤‰à¤§à¤¾à¤° à¤¬à¤¹à¥€','label-addprod':'à¤¸à¤¾à¤®à¤¾à¤¨ à¤œà¥‹à¤¡à¤¼à¥‡à¤‚',
    'label-pname':'à¤¨à¤¾à¤®','label-punit':'à¤‡à¤•à¤¾à¤ˆ','label-pstock':'à¤¸à¥à¤Ÿà¥‰à¤•',
    'label-pbuy':'à¤–à¤°à¥€à¤¦ â‚¹','label-psell':'à¤¬à¤¿à¤•à¥à¤°à¥€ â‚¹','label-total-due':'à¤•à¥à¤² à¤¬à¤•à¤¾à¤¯à¤¾',
    'label-empty-txn':'à¤†à¤œ à¤•à¥‹à¤ˆ à¤²à¥‡à¤¨-à¤¦à¥‡à¤¨ à¤¨à¤¹à¥€à¤‚','label-empty-inv':'à¤•à¥‹à¤ˆ à¤¸à¤¾à¤®à¤¾à¤¨ à¤¨à¤¹à¥€à¤‚',
    'label-empty-udhaar':'à¤•à¥‹à¤ˆ à¤‰à¤§à¤¾à¤° à¤¨à¤¹à¥€à¤‚',
    'voice-hint':'à¤†à¤œ à¤®à¥ˆà¤‚à¤¨à¥‡ 5 à¤²à¥€à¤Ÿà¤° à¤¦à¥‚à¤§ à¤”à¤° 2 à¤•à¤¿à¤²à¥‹ à¤šà¥€à¤¨à¥€ à¤¬à¥‡à¤šà¥€',
    'micLabel':'à¤¬à¥‹à¤²à¤¨à¤¾ à¤¶à¥à¤°à¥‚ à¤•à¤°à¥‡à¤‚','transcriptBox':'à¤¯à¤¹à¤¾à¤ à¤†à¤ªà¤•à¥€ à¤†à¤µà¤¾à¤œà¤¼ à¤¦à¤¿à¤–à¥‡à¤—à¥€...',
  },
  mr: {
    'label-voice':'à¤†à¤µà¤¾à¤œ à¤à¤‚à¤Ÿà¥à¤°à¥€','label-dashboard':'à¤¡à¥…à¤¶à¤¬à¥‹à¤°à¥à¤¡','label-revenue':'à¤µà¤¿à¤•à¥à¤°à¥€',
    'label-profit':'à¤¨à¤«à¤¾','label-txn-count':'à¤µà¥à¤¯à¤µà¤¹à¤¾à¤°','label-txns':'à¤…à¤²à¥€à¤•à¤¡à¥€à¤² à¤µà¥à¤¯à¤µà¤¹à¤¾à¤°',
    'label-inventory':'à¤¸à¥à¤Ÿà¥‰à¤•','label-udhaar':'à¤‰à¤§à¤¾à¤°à¥€ à¤µà¤¹à¥€','label-addprod':'à¤®à¤¾à¤² à¤œà¥‹à¤¡à¤¾',
    'label-pname':'à¤¨à¤¾à¤µ','label-punit':'à¤à¤•à¤•','label-pstock':'à¤¸à¤¾à¤ à¤¾',
    'label-pbuy':'à¤–à¤°à¥‡à¤¦à¥€ â‚¹','label-psell':'à¤µà¤¿à¤•à¥à¤°à¥€ â‚¹','label-total-due':'à¤à¤•à¥‚à¤£ à¤¥à¤•à¤¬à¤¾à¤•à¥€',
    'label-empty-txn':'à¤†à¤œ à¤•à¥‹à¤£à¤¤à¥‡à¤¹à¥€ à¤µà¥à¤¯à¤µà¤¹à¤¾à¤° à¤¨à¤¾à¤¹à¥€','label-empty-inv':'à¤•à¥‹à¤£à¤¤à¤¾à¤¹à¥€ à¤®à¤¾à¤² à¤¨à¤¾à¤¹à¥€',
    'label-empty-udhaar':'à¤•à¥‹à¤£à¤¤à¥€à¤¹à¥€ à¤‰à¤§à¤¾à¤°à¥€ à¤¨à¤¾à¤¹à¥€',
    'voice-hint':'à¤†à¤œ à¤®à¥€ 5 à¤²à¥€à¤Ÿà¤° à¤¦à¥‚à¤§ à¤†à¤£à¤¿ 2 à¤•à¤¿à¤²à¥‹ à¤¸à¤¾à¤–à¤° à¤µà¤¿à¤•à¤²à¥€',
    'micLabel':'à¤¬à¥‹à¤²à¤£à¥‡ à¤¸à¥à¤°à¥‚ à¤•à¤°à¤¾','transcriptBox':'à¤¯à¥‡à¤¥à¥‡ à¤¤à¥à¤®à¤šà¤¾ à¤†à¤µà¤¾à¤œ à¤¦à¤¿à¤¸à¥‡à¤²...',
  },
  ta: {
    'label-voice':'à®•à¯à®°à®²à¯ à®‰à®³à¯à®³à¯€à®Ÿà¯','label-dashboard':'à®Ÿà®¾à®·à¯à®ªà¯‹à®°à¯à®Ÿà¯','label-revenue':'à®µà®°à¯à®µà®¾à®¯à¯',
    'label-profit':'à®²à®¾à®ªà®®à¯','label-txn-count':'à®ªà®°à®¿à®µà®°à¯à®¤à¯à®¤à®©à¯ˆà®•à®³à¯','label-txns':'à®šà®®à¯€à®ªà®¤à¯à®¤à®¿à®¯ à®ªà®°à®¿à®µà®°à¯à®¤à¯à®¤à®©à¯ˆà®•à®³à¯',
    'label-inventory':'à®šà®°à®•à¯à®•à¯','label-udhaar':'à®•à®Ÿà®©à¯ à®ªà¯à®¤à¯à®¤à®•à®®à¯','label-addprod':'à®ªà¯Šà®°à¯à®³à¯ à®šà¯‡à®°à¯',
    'label-pname':'à®ªà¯†à®¯à®°à¯','label-punit':'à®…à®²à®•à¯','label-pstock':'à®•à¯ˆà®¯à®¿à®°à¯à®ªà¯à®ªà¯',
    'label-pbuy':'à®µà®¾à®™à¯à®•à®²à¯ â‚¹','label-psell':'à®µà®¿à®±à¯à®ªà®©à¯ˆ â‚¹','label-total-due':'à®®à¯Šà®¤à¯à®¤ à®¨à®¿à®²à¯à®µà¯ˆ',
    'label-empty-txn':'à®‡à®©à¯à®±à¯ à®ªà®°à®¿à®µà®°à¯à®¤à¯à®¤à®©à¯ˆ à®‡à®²à¯à®²à¯ˆ','label-empty-inv':'à®ªà¯Šà®°à¯à®Ÿà¯à®•à®³à¯ à®‡à®²à¯à®²à¯ˆ',
    'label-empty-udhaar':'à®•à®Ÿà®©à¯ à®ªà®¤à®¿à®µà¯à®•à®³à¯ à®‡à®²à¯à®²à¯ˆ',
    'voice-hint':'à®‡à®©à¯à®±à¯ 5 à®²à®¿à®Ÿà¯à®Ÿà®°à¯ à®ªà®¾à®²à¯ à®®à®±à¯à®±à¯à®®à¯ 2 à®•à®¿à®²à¯‹ à®šà®°à¯à®•à¯à®•à®°à¯ˆ à®µà®¿à®±à¯à®±à¯‡à®©à¯',
    'micLabel':'à®ªà¯‡à®š à®¤à¯Šà®Ÿà®™à¯à®•à¯à®™à¯à®•à®³à¯','transcriptBox':'à®‰à®™à¯à®•à®³à¯ à®•à¯à®°à®²à¯ à®‡à®™à¯à®•à¯‡ à®¤à¯‹à®©à¯à®±à¯à®®à¯...',
  },
  ml: {
    'label-voice':'à´¶à´¬àµà´¦ à´àµ»à´Ÿàµà´°à´¿','label-dashboard':'à´¡à´¾à´·àµà´¬àµ‹àµ¼à´¡àµ','label-revenue':'à´µà´°àµà´®à´¾à´¨à´‚',
    'label-profit':'à´²à´¾à´­à´‚','label-txn-count':'à´‡à´Ÿà´ªà´¾à´Ÿàµà´•àµ¾','label-txns':'à´¸à´®àµ€à´ªà´•à´¾à´² à´‡à´Ÿà´ªà´¾à´Ÿàµà´•àµ¾',
    'label-inventory':'à´¸àµà´±àµà´±àµ‹à´•àµà´•àµ','label-udhaar':'à´•à´Ÿà´‚ à´¬àµà´•àµà´•àµ','label-addprod':'à´‰àµ½à´ªàµà´ªà´¨àµà´¨à´‚ à´šàµ‡àµ¼à´•àµà´•àµà´•',
    'label-pname':'à´ªàµ‡à´°àµ','label-punit':'à´¯àµ‚à´£à´¿à´±àµà´±àµ','label-pstock':'à´¸àµà´±àµà´±àµ‹à´•àµà´•àµ',
    'label-pbuy':'à´µà´¾à´™àµà´™àµ½ â‚¹','label-psell':'à´µà´¿àµ½à´ªàµà´ªà´¨ â‚¹','label-total-due':'à´†à´•àµ† à´•à´Ÿà´‚',
    'label-empty-txn':'à´‡à´¨àµà´¨àµ à´’à´°àµ à´‡à´Ÿà´ªà´¾à´Ÿàµà´‚ à´‡à´²àµà´²','label-empty-inv':'à´‰àµ½à´ªàµà´ªà´¨àµà´¨à´™àµà´™àµ¾ à´‡à´²àµà´²',
    'label-empty-udhaar':'à´•à´Ÿà´‚ à´àµ»à´Ÿàµà´°à´¿à´•àµ¾ à´‡à´²àµà´²',
    'voice-hint':'à´‡à´¨àµà´¨àµ 5 à´²à´¿à´±àµà´±àµ¼ à´ªà´¾à´²àµà´‚ 2 à´•à´¿à´²àµ‹ à´ªà´àµà´šà´¸à´¾à´°à´¯àµà´‚ à´µà´¿à´±àµà´±àµ',
    'micLabel':'à´¸à´‚à´¸à´¾à´°à´¿à´•àµà´•àµ‚','transcriptBox':'à´¨à´¿à´™àµà´™à´³àµà´Ÿàµ† à´¶à´¬àµà´¦à´‚ à´‡à´µà´¿à´Ÿàµ† à´•à´¾à´£àµà´‚...',
  },
  en: {
    'label-voice':'Voice Entry','label-dashboard':'Dashboard','label-revenue':'Revenue',
    'label-profit':'Profit','label-txn-count':'Transactions','label-txns':'Recent Transactions',
    'label-inventory':'Inventory','label-udhaar':'Udhaar Ledger','label-addprod':'Add Product',
    'label-pname':'Name','label-punit':'Unit','label-pstock':'Stock',
    'label-pbuy':'Buy â‚¹','label-psell':'Sell â‚¹','label-total-due':'Total Outstanding',
    'label-empty-txn':'No transactions recorded today','label-empty-inv':'No products added yet',
    'label-empty-udhaar':'No credit entries',
    'voice-hint':'Today I sold 5 liters of milk and 2 kg of sugar',
    'micLabel':'Start speaking','transcriptBox':'Your voice will appear here...',
  },
};

const speechLangMap = { hi:'hi-IN', mr:'mr-IN', ta:'ta-IN', ml:'ml-IN', en:'en-IN' };
let currentLang = 'hi';

function setLang(lang, btn) {
  currentLang = lang;
  document.querySelectorAll('.lang-btn').forEach(b => b.classList.remove('active'));
  btn.classList.add('active');
  const t = T[lang];
  Object.entries(t).forEach(([id, val]) => {
    const el = document.getElementById(id);
    if (!el) return;
    if (el.tagName === 'INPUT' || el.tagName === 'TEXTAREA') el.placeholder = val;
    else el.textContent = val;
  });
  const tb = document.getElementById('transcriptBox');
  if (!tb.classList.contains('has-text') && !tb.classList.contains('loading'))
    tb.textContent = t['transcriptBox'];
  document.getElementById('micLabel').textContent = t['micLabel'];
  document.getElementById('voice-hint').textContent = t['voice-hint'];
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// STATE
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
let isRecording    = false;
let audioBlob      = null;
let transcript     = '';
let parsedData     = null;
let confidence     = 0;

let mediaRecorder    = null;
let audioChunks      = [];
let recInterval      = null;
let recSecs          = 0;

let inventory = [
  { name:'à¤¦à¥‚à¤§',      unit:'litre', stock:20, maxStock:30, buyPrice:40,  sellPrice:50  },
  { name:'à¤šà¥€à¤¨à¥€',     unit:'kg',    stock:8,  maxStock:20, buyPrice:38,  sellPrice:45  },
  { name:'à¤šà¤¾à¤¯ à¤ªà¤¤à¥à¤¤à¥€',unit:'kg',    stock:2,  maxStock:10, buyPrice:200, sellPrice:260 },
  { name:'à´ªà´¾àµ½',      unit:'litre', stock:15, maxStock:25, buyPrice:42,  sellPrice:52  },
  { name:'à´ªà´àµà´šà´¸à´¾à´°',  unit:'kg',    stock:10, maxStock:15, buyPrice:40,  sellPrice:50  },
];
let transactions  = [];
let udhaarEntries = [];
let todayRevenue  = 0;
let todayProfit   = 0;
let todayTxnCount = 0;

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// NLP PARSER
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const itemAliases = {
  'à¤¦à¥‚à¤§':        ['à¤¦à¥‚à¤§','milk','à¤¦à¥à¤§','à®ªà®¾à®²à¯','à´ªà´¾àµ½','paal'],
  'à¤šà¥€à¤¨à¥€':       ['à¤šà¥€à¤¨à¥€','sugar','à¤¶à¤•à¥à¤•à¤°','à¤¸à¤¾à¤–à¤°','à®šà®°à¯à®•à¯à®•à®°à¯ˆ','à´ªà´àµà´šà´¸à´¾à´°','panjasara','chini'],
  'à¤šà¤¾à¤¯ à¤ªà¤¤à¥à¤¤à¥€':  ['à¤šà¤¾à¤¯','tea','à¤šà¤¹à¤¾','à®¤à¯‡à®¯à®¿à®²à¯ˆ','à´šà´¾à´¯','chai'],
  'à¤†à¤Ÿà¤¾':        ['à¤†à¤Ÿà¤¾','flour','à¤ªà¤¿à¤ ','à®®à®¾à®µà¯','à´®àµˆà´¦'],
  'à¤šà¤¾à¤µà¤²':       ['à¤šà¤¾à¤µà¤²','rice','à¤¤à¤¾à¤‚à¤¦à¥‚à¤³','à®…à®°à®¿à®šà®¿','à´…à´°à´¿'],
};
const saleKw     = ['à¤¬à¥‡à¤šà¥€','à¤¬à¥‡à¤šà¤¾','à¤¬à¥‡à¤šà¥‡','sold','sale','à¤µà¤¿à¤•à¤²à¥€','à®µà®¿à®±à¯à®±à¯‡à®©à¯','à´µà´¿à´±àµà´±àµ','becha'];
const purchaseKw = ['à¤–à¤°à¥€à¤¦à¥€','à¤–à¤°à¥€à¤¦à¤¾','bought','purchase','à¤–à¤°à¥‡à¤¦à¥€','à®µà®¾à®™à¯à®•à®¿à®©à¯‡à®©à¯','à´µà´¾à´™àµà´™à´¿','kharida'];
const unitAliases = {
  litre:  ['à¤²à¥€à¤Ÿà¤°','litre','liter','l','à®²à®¿à®Ÿà¯à®Ÿà®°à¯','à´²à´¿à´±àµà´±àµ¼'],
  kg:     ['à¤•à¤¿à¤²à¥‹','kg','kilogram','kilo','à®•à®¿à®²à¯‹','à´•à´¿à´²àµ‹'],
  piece:  ['piece','pieces','pcs','à¤¨à¤—','à®à®£à¯à®£à®¿à®•à¯à®•à¯ˆ','à´à´£àµà´£à´‚'],
  packet: ['packet','pack','à¤ªà¥ˆà¤•à¥‡à¤Ÿ','à®ªà®¾à®•à¯à®•à¯†à®Ÿà¯','à´ªà´¾à´•àµà´•à´±àµà´±àµ'],
  dozen:  ['dozen','à¤¦à¤°à¥à¤œà¤¨','à®Ÿà®œà®©à¯','à´¡à´¸àµ»'],
};

function parseTranscript(text) {
  const lo = text.toLowerCase();
  const type = purchaseKw.some(k => lo.includes(k.toLowerCase())) ? 'purchase' : 'sale';
  let item = null;
  for (const [c, al] of Object.entries(itemAliases)) {
    if (al.some(a => lo.includes(a.toLowerCase()))) { item = c; break; }
  }
  if (!item) {
    for (const p of inventory) {
      if (lo.includes(p.name.toLowerCase())) { item = p.name; break; }
    }
  }
  const nm = text.match(/(\d+(\.\d+)?)/);
  const quantity = nm ? parseFloat(nm[1]) : 1;
  let unit = 'piece';
  for (const [c, al] of Object.entries(unitAliases)) {
    if (al.some(a => lo.includes(a.toLowerCase()))) { unit = c; break; }
  }
  if (unit === 'piece' && item) {
    const p = inventory.find(x => x.name === item);
    if (p) unit = p.unit;
  }
  let score = 0.35;
  if (item) score += 0.35;
  if (nm) score += 0.2;
  if ([...saleKw,...purchaseKw].some(k => lo.includes(k.toLowerCase()))) score += 0.1;
  return { transcript: text, item, quantity, unit, type, confidence: Math.min(0.99, score) };
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// MEDIA RECORDER
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
async function toggleRecording() {
  if (isRecording) { stopRecording(); return; }
  await startRecording();
}

async function startRecording() {
  let stream;
  try {
    stream = await navigator.mediaDevices.getUserMedia({ audio: true });
  } catch(e) {
    const msgs = { NotAllowedError:'ğŸ¤ Microphone access denied â€” enable in browser settings.', NotFoundError:'ğŸ”‡ No microphone found.' };
    showToast(msgs[e.name] || 'âš ï¸ ' + e.message, 'error');
    return;
  }

  audioChunks = []; isRecording = true; recSecs = 0;
  mediaRecorder = new MediaRecorder(stream, { mimeType: bestMime() });
  mediaRecorder.ondataavailable = e => { if (e.data.size > 0) audioChunks.push(e.data); };
  mediaRecorder.onstop = async () => {
    stream.getTracks().forEach(t => t.stop());
    audioBlob = new Blob(audioChunks, { type: mediaRecorder.mimeType });
    await processBlob(audioBlob);
  };
  mediaRecorder.start(200);

  // UI
  setRecordingUI(true);
  recInterval = setInterval(() => {
    recSecs++;
    const m = Math.floor(recSecs/60), s = String(recSecs%60).padStart(2,'0');
    document.getElementById('recTimer').textContent = `${m}:${s}`;
    if (recSecs >= 60) stopRecording();
  }, 1000);
}

function stopRecording() {
  if (!isRecording || !mediaRecorder) return;
  isRecording = false;
  clearInterval(recInterval);
  mediaRecorder.stop();
  setProcessingUI();
}

function bestMime() {
  const types = ['audio/webm;codecs=opus','audio/webm','audio/ogg;codecs=opus','audio/mp4'];
  return types.find(t => MediaRecorder.isTypeSupported(t)) || '';
}

function setRecordingUI(on) {
  const btn = document.getElementById('micBtn');
  const outer = document.getElementById('micOuter');
  const badge = document.getElementById('recBadge');
  btn.textContent = on ? 'â¹' : 'ğŸ¤';
  btn.className = on ? 'mic-inner recording' : 'mic-inner';
  outer.className = on ? 'mic-outer recording-ring' : 'mic-outer armed';
  badge.textContent = on ? 'LIVE'; badge.className = on ? 'card-badge live' : 'card-badge idle';
  document.getElementById('recDot').classList.toggle('active', on);
  document.getElementById('recTimer').classList.toggle('active', on);
  document.getElementById('waveform').classList.toggle('active', on);
  document.getElementById('micLabel').textContent = on
    ? 'â¬¤ Recording â€” tap to stop'
    : T[currentLang]['micLabel'];
  document.getElementById('micLabel').className = on ? 'mic-state-label live' : 'mic-state-label';
  const tb = document.getElementById('transcriptBox');
  if (on) { tb.textContent = '...'; tb.className = 'transcript-area'; }
}

function setProcessingUI() {
  const btn = document.getElementById('micBtn');
  const outer = document.getElementById('micOuter');
  btn.textContent = 'â³'; btn.className = 'mic-inner processing'; btn.disabled = true;
  outer.className = 'mic-outer processing-ring';
  document.getElementById('recBadge').textContent = 'PROCESSING';
  document.getElementById('recBadge').className = 'card-badge live';
  document.getElementById('waveform').classList.remove('active');
  document.getElementById('recDot').classList.remove('active');
  document.getElementById('recTimer').classList.remove('active');
  document.getElementById('micLabel').textContent = 'Sending to API...';
  document.getElementById('micLabel').className = 'mic-state-label proc';
  const tb = document.getElementById('transcriptBox');
  tb.textContent = 'Processing audio'; tb.className = 'transcript-area loading';
}

function resetMicUI() {
  const btn = document.getElementById('micBtn');
  const outer = document.getElementById('micOuter');
  btn.textContent = 'ğŸ¤'; btn.className = 'mic-inner'; btn.disabled = false;
  outer.className = 'mic-outer';
  document.getElementById('recBadge').textContent = 'IDLE';
  document.getElementById('recBadge').className = 'card-badge idle';
  document.getElementById('micLabel').textContent = T[currentLang]['micLabel'];
  document.getElementById('micLabel').className = 'mic-state-label';
  document.getElementById('recTimer').textContent = '0:00';
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// PROCESS BLOB â†’ FORMDATA â†’ BACKEND (mocked)
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
async function processBlob(blob) {
  const fd = new FormData();
  fd.append('audio', blob, 'recording.webm');
  fd.append('language', currentLang);
  fd.append('languageCode', speechLangMap[currentLang] || 'hi-IN');

  /*
  â”€â”€ REAL BACKEND INTEGRATION â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  const res  = await fetch('/api/bhashini/asr', { method:'POST', body: fd });
  const data = await res.json();
  // Expected: { transcript, item, quantity, unit, type, confidence }
  handleResponse(data);
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */

  const mocks = [
    'à¤†à¤œ à¤®à¥ˆà¤‚à¤¨à¥‡ 5 à¤²à¥€à¤Ÿà¤° à¤¦à¥‚à¤§ à¤¬à¥‡à¤šà¥€',
    '2 à¤•à¤¿à¤²à¥‹ à¤šà¥€à¤¨à¥€ à¤¬à¥‡à¤šà¤¾',
    'à´‡à´¨àµà´¨àµ 3 à´²à´¿à´±àµà´±àµ¼ à´ªà´¾àµ½ à´µà´¿à´±àµà´±àµ',
    'à´‡à´¨àµà´¨àµ 5 à´•à´¿à´²àµ‹ à´ªà´àµà´šà´¸à´¾à´° à´µà´¾à´™àµà´™à´¿',
    '10 à¤²à¥€à¤Ÿà¤° à¤¦à¥‚à¤§ à¤–à¤°à¥€à¤¦à¤¾',
    '3 à¤•à¤¿à¤²à¥‹ à¤šà¤¾à¤¯ à¤ªà¤¤à¥à¤¤à¥€ à¤¬à¥‡à¤šà¥€',
  ];
  await new Promise(r => setTimeout(r, 900));
  handleResponse(parseTranscript(mocks[Math.floor(Math.random() * mocks.length)]));
}

function handleResponse(data) {
  resetMicUI();
  transcript = data.transcript;
  parsedData = data;
  confidence = data.confidence || 0;

  const tb = document.getElementById('transcriptBox');
  tb.textContent = data.transcript;
  tb.className = 'transcript-area has-text';

  openModal(data);
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// MODAL
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function openModal(data) {
  document.getElementById('modalQuote').textContent = '"' + data.transcript + '"';

  const pct = Math.round((data.confidence || 0) * 100);
  const cls = pct >= 75 ? 'hi' : pct >= 45 ? 'mid' : 'lo';
  const badge = document.getElementById('confBadge');
  badge.textContent = pct + '%';
  badge.className = 'conf-badge ' + cls;
  const bar = document.getElementById('confBar');
  bar.className = 'conf-bar ' + cls;
  requestAnimationFrame(() => { setTimeout(() => { bar.style.width = pct + '%'; }, 50); });

  document.getElementById('mItem').value = data.item || '';
  document.getElementById('mQty').value  = data.quantity || 1;
  document.getElementById('mType').value = data.type || 'sale';

  document.getElementById('overlay').classList.add('show');
}

function closeModal() {
  document.getElementById('overlay').classList.remove('show');
  setTimeout(() => { document.getElementById('confBar').style.width = '0%'; }, 300);
}

document.getElementById('overlay').addEventListener('click', e => {
  if (e.target === document.getElementById('overlay')) closeModal();
});

function confirmFromModal() {
  const item = document.getElementById('mItem').value.trim();
  const qty  = parseFloat(document.getElementById('mQty').value) || 1;
  const type = document.getElementById('mType').value;
  const unit = parsedData ? parsedData.unit : 'piece';

  if (!item) { showToast('âš ï¸ Product name required', 'error'); return; }
  const idx = inventory.findIndex(p => p.name === item);
  if (idx === -1) { showToast('â— Product not in inventory', 'error'); return; }

  const prod = inventory[idx];
  if (type === 'sale') {
    inventory[idx].stock = Math.max(0, prod.stock - qty);
    const rev = qty * prod.sellPrice;
    const profit = qty * (prod.sellPrice - prod.buyPrice);
    todayRevenue += rev; todayProfit += profit; todayTxnCount++;
    addTransaction({ name: item, qty, unit, type: 'sale', amount: rev });
  } else {
    inventory[idx].stock += qty;
    const cost = qty * prod.buyPrice;
    todayTxnCount++;
    addTransaction({ name: item, qty, unit, type: 'purchase', amount: -cost });
  }

  closeModal();
  renderInventory();
  renderDashboard();
  const tb = document.getElementById('transcriptBox');
  tb.textContent = T[currentLang]['transcriptBox'];
  tb.className = 'transcript-area';
  parsedData = null;
  showToast('âœ“ Entry saved', 'success');
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// RENDER FUNCTIONS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function addTransaction(txn) {
  transactions.unshift({ ...txn, time: new Date() });
  if (transactions.length > 5) transactions = transactions.slice(0, 5);
  renderTransactions();
}

function renderTransactions() {
  const el = document.getElementById('txnTable');
  if (!transactions.length) {
    el.innerHTML = `<div class="empty">${T[currentLang]['label-empty-txn']}</div>`; return;
  }
  el.innerHTML = transactions.map(t => {
    const icon   = t.type === 'sale' ? 'â†‘' : 'â†“';
    const amtCls = t.type === 'sale' ? 'pos' : 'neg';
    const sign   = t.type === 'sale' ? '+' : 'âˆ’';
    const time   = t.time.toLocaleTimeString('en-IN',{hour:'2-digit',minute:'2-digit'});
    return `
    <div class="txn-row">
      <div class="txn-icon ${t.type}">${icon}</div>
      <div>
        <div class="txn-name">${t.name}</div>
        <div class="txn-sub">${t.qty} ${t.unit}</div>
      </div>
      <div class="txn-time">${time}</div>
      <div class="txn-amount ${amtCls}">${sign}â‚¹${Math.abs(t.amount)}</div>
    </div>`;
  }).join('');
}

function renderInventory() {
  const el = document.getElementById('invList');
  if (!inventory.length) {
    el.innerHTML = `<div class="empty">${T[currentLang]['label-empty-inv']}</div>`; return;
  }
  el.innerHTML = inventory.map(p => {
    const pct = Math.min(100, (p.stock / (p.maxStock || 1)) * 100);
    const cls = pct > 50 ? 'hi' : pct > 20 ? 'mid' : 'lo';
    return `
    <div class="inv-row">
      <div>
        <div class="inv-name">${p.name}</div>
        <div class="inv-stock">${p.stock} ${p.unit}</div>
        <div class="stock-track"><div class="stock-fill ${cls}" style="width:${pct}%"></div></div>
      </div>
      <div class="inv-right">
        ${pct<=20 ? '<span class="badge-low">Low</span>' : ''}
        <span class="inv-price">â‚¹${p.sellPrice}/${p.unit[0]}</span>
      </div>
    </div>`;
  }).join('');
}

function renderDashboard() {
  document.getElementById('statRevenue').textContent  = 'â‚¹' + todayRevenue;
  document.getElementById('statProfit').textContent   = 'â‚¹' + todayProfit;
  document.getElementById('statTxnCount').textContent = todayTxnCount;
}

function addProduct() {
  const name  = document.getElementById('prodName').value.trim();
  const unit  = document.getElementById('prodUnit').value;
  const stock = parseFloat(document.getElementById('prodStock').value) || 0;
  const buy   = parseFloat(document.getElementById('prodBuy').value) || 0;
  const sell  = parseFloat(document.getElementById('prodSell').value) || 0;
  if (!name) { showToast('âš ï¸ Product name required', 'error'); return; }
  inventory.push({ name, unit, stock, maxStock: Math.max(stock*2,20), buyPrice:buy, sellPrice:sell });
  renderInventory();
  ['prodName','prodStock','prodBuy','prodSell'].forEach(id => document.getElementById(id).value = '');
  showToast('ğŸ“¦ Product added', 'success');
}

function addUdhaar() {
  const name = document.getElementById('udhaarName').value.trim();
  const amt  = parseFloat(document.getElementById('udhaarAmt').value) || 0;
  if (!name || !amt) { showToast('Fill customer and amount', 'error'); return; }
  udhaarEntries.unshift({ name, amt, date: new Date() });
  document.getElementById('udhaarName').value = '';
  document.getElementById('udhaarAmt').value  = '';
  renderUdhaar();
  showToast('ğŸ“’ Credit entry added', 'success');
}

function renderUdhaar() {
  const el    = document.getElementById('udhaarList');
  const total = udhaarEntries.reduce((s,u) => s+u.amt, 0);
  document.getElementById('totalDue').textContent = 'â‚¹' + total;
  if (!udhaarEntries.length) {
    el.innerHTML = `<div class="empty">${T[currentLang]['label-empty-udhaar']}</div>`; return;
  }
  el.innerHTML = udhaarEntries.slice(0,5).map(u => `
    <div class="udhaar-row">
      <div>
        <div class="udhaar-name">${u.name}</div>
        <div class="udhaar-date">${u.date.toLocaleDateString('en-IN')}</div>
      </div>
      <div class="udhaar-amt">â‚¹${u.amt}</div>
    </div>`).join('');
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// TOAST
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
let toastT;
function showToast(msg, type='success') {
  const el = document.getElementById('toast');
  el.textContent = msg; el.className = 'toast ' + type + ' show';
  clearTimeout(toastT);
  toastT = setTimeout(() => el.classList.remove('show'), 2800);
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// INIT
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const now = new Date();
document.getElementById('topbarDate').textContent =
  now.toLocaleDateString('en-IN',{weekday:'short',day:'numeric',month:'short'});
document.getElementById('dashDate').textContent =
  now.toLocaleDateString('en-IN',{day:'numeric',month:'long',year:'numeric'});

renderInventory();
renderTransactions();
renderDashboard();
renderUdhaar();
</script>
</body>
</html>
